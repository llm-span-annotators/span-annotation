# Large Language Models as Span Annotators

This repository contains data and resources for the paper "Large Language Models as Span Annotators".

## Repository Structure

### Inputs

The `inputs` directory contains the source data:

- **d2t-eval**: Data-to-text inputs organized by domain (football, gsmarena, openweather). The examples are implicitly indexed by their position in the list.

- **mt-eval**: A sample from the [WMT24 dataset](https://www2.statmt.org/wmt24/mtdata/) (sampled ids provided in `utils/wmt_sample.csv`).

Note that there are no inputs for the propaganda task.

### Outputs Directory

The `outputs` directory contains the outputs:

- **d2t-eval**: Outputs generated by LLMs (phi3-5, gpt4o, gemma2, llama3-3).
- **mt-eval**: Translations of the sampled inputs from the [WMT24 dataset](https://www2.statmt.org/wmt24/mtdata/).
- **propaganda**: Texts from the `test` split from the [Propaganda Techniques Corpus](https://aclanthology.org/D19-1565/).

Each output file is a JSONL file with the following structure:

```json
{
  "dataset": [dataset_id], 
  "split": [split_id],
  "setup_id": [setup_id],
  "example_idx": [example_index], 
  "output": [output_text]
}
```

### Annotations Directory

The annotations directory contains the span annotations:

- **model**: Collected annotations from LLMs.
- **human**: Reference annotations from human annotators.

#### config.yaml

Configuration files contain:
- For human annotations:
  - `annotation_span_categories`: Categories for span annotation with name and description.
  - `annotator_instructions`: Instructions for human annotators.
  - `annotation_granularity`: Level of annotation (words / characters.)
  - `annotation_overlap_allowed`: Whether spans can overlap
  - `campaign_orig_id`: Original id of the internal campaign.

- For model annotations:
  - `annotation_span_categories`: Categories for span annotation with name and description.
  - `prompt_template`: The template used to prompt the model.
  - `model`: The model identifier (e.g., deepseek-r1:70b)
  - `model_args`: Additional model parameters
  - `campaign_orig_id`: Original id of the internal campaign.

#### annotations.jsonl

Each line in an annotations.jsonl file contains a JSON object with:
- `dataset`: The dataset id
- `split`: The split id
- `setup_id`: The setup id
- `example_idx`: The example index
- `annotations`: Array of span annotations, each with:
  - `type`: Integer indicating the annotation category (0-indexed)
  - `text`: The text of the annotated span
  - `start`: Character position where the span starts
  - `id`: Unique identifier for the annotation
- `annotator_group`: Annotator group (a single output can have annotation sets from different groups).